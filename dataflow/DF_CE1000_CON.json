{
	"name": "DF_CE1000_CON",
	"properties": {
		"folder": {
			"name": "Datalake_Levis/02 Retail/03 Consumo"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DL_CE11000_ST_MANUAL",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CE11000_CON_MANUAL",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     NombreArchivo as string (concat('CE11000_',substring(BUDAT,1,6),'.parquet'))",
				"}",
				"source(output(",
				"          MANDT as string,",
				"          PALEDGER as string,",
				"          VRGAR as string,",
				"          VERSI as string,",
				"          PERIO as string,",
				"          PAOBJNR as string,",
				"          PASUBNR as string,",
				"          BELNR as string,",
				"          POSNR as string,",
				"          HZDAT as string,",
				"          USNAM as string,",
				"          GJAHR as string,",
				"          PERDE as string,",
				"          WADAT as string,",
				"          FADAT as string,",
				"          BUDAT as string,",
				"          ALTPERIO as string,",
				"          PAPAOBJNR as string,",
				"          PAPASUBNR as string,",
				"          KNDNR as string,",
				"          ARTNR as string,",
				"          FKART as string,",
				"          FRWAE as string,",
				"          KURSF as string,",
				"          KURSBK as string,",
				"          KURSKZ as string,",
				"          REC_WAERS as string,",
				"          KAUFN as string,",
				"          KDPOS as string,",
				"          RKAUFNR as string,",
				"          SKOST as string,",
				"          PRZNR as string,",
				"          BUKRS as string,",
				"          KOKRS as string,",
				"          WERKS as string,",
				"          GSBER as string,",
				"          VKORG as string,",
				"          VTWEG as string,",
				"          SPART as string,",
				"          HRKFT as string,",
				"          PLIKZ as string,",
				"          KSTAR as string,",
				"          PSPNR as string,",
				"          KSTRG as string,",
				"          RBELN as string,",
				"          RPOSN as string,",
				"          STO_BELNR as string,",
				"          STO_POSNR as string,",
				"          PRCTR as string,",
				"          PPRCTR as string,",
				"          RKESTATU as string,",
				"          TIMESTMP as string,",
				"          COPA_AWTYP as string,",
				"          COPA_AWORG as string,",
				"          COPA_BWZPT as string,",
				"          COPA_AWSYS as string,",
				"          KMMAKL as string,",
				"          KMVTNR as string,",
				"          WW010 as string,",
				"          WW020 as string,",
				"          WW021 as string,",
				"          WW022 as string,",
				"          WW023 as string,",
				"          WW024 as string,",
				"          WGRU1 as string,",
				"          MTART as string,",
				"          PMATA as string,",
				"          KUNRG as string,",
				"          WW025 as string,",
				"          WW026 as string,",
				"          WW027 as string,",
				"          WW028 as string,",
				"          WW029 as string,",
				"          WW030 as string,",
				"          WW031 as string,",
				"          WW032 as string,",
				"          WW033 as string,",
				"          WW034 as string,",
				"          WW035 as string,",
				"          ABSMG_ME as string,",
				"          VV006_ME as string,",
				"          ERLOS as string,",
				"          KWAKRB as string,",
				"          KWKDRB as string,",
				"          KWMARB as string,",
				"          KWMGRB as string,",
				"          KWSKTO as string,",
				"          KWSOHD as string,",
				"          MRABA as string,",
				"          RABAT as string,",
				"          ABSMG as string,",
				"          VV001 as string,",
				"          VV002 as string,",
				"          VV003 as string,",
				"          VV004 as string,",
				"          VV005 as string,",
				"          VV006 as string,",
				"          TIPO_CAMBIO as string,",
				"          MONEDA as string,",
				"          TASA_CAMBIO as string,",
				"          SAP_ID as string,",
				"          OPEN_DATE as string,",
				"          GROSS_SIZE as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(KURSF = toDecimal(KURSF,15,2),",
				"          KURSBK = toDecimal(KURSBK,15,2),",
				"          KURSKZ = toDecimal(KURSKZ,15,2),",
				"          TIMESTMP = toDecimal( TIMESTMP,15,2),",
				"          GROSS_SIZE = toDecimal(GROSS_SIZE,15,2),",
				"          TASA_CAMBIO = toDecimal( TASA_CAMBIO,15,5),",
				"          ERLOS = toDecimal(ERLOS,15,2),",
				"          KWAKRB = toDecimal(KWAKRB,15,2),",
				"          KWKDRB = toDecimal( KWKDRB,15,2),",
				"          KWMARB = toDecimal(KWMARB,15,2),",
				"          KWMGRB = toDecimal(KWMGRB,15,2),",
				"          KWSKTO = toDecimal(KWSKTO,15,2),",
				"          KWSOHD = toDecimal(KWSOHD,15,2),",
				"          MRABA = toDecimal(MRABA,15,2),",
				"          RABAT = toDecimal(RABAT,15,2),",
				"          ABSMG = toDecimal(ABSMG,15,2),",
				"          VV001 = toDecimal( VV001,15,2),",
				"          VV002 = toDecimal(VV002,15,2),",
				"          VV003 = toDecimal( VV003,15,2),",
				"          VV004 = toDecimal(VV004 ,15,2),",
				"          VV005 = toDecimal(VV005 ,15,2),",
				"          VV006 = toDecimal(VV006 ,15,2)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     partitionFileNames:[($NombreArchivo)],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}