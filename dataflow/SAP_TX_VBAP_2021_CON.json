{
	"name": "SAP_TX_VBAP_2021_CON",
	"properties": {
		"folder": {
			"name": "Datalake_Levis/Transacciones/02 Consumption"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "TX_VBAP_2021_ST",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DL_PQT_VBAP",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          MANDT as string,",
				"          VBELN as string,",
				"          POSNR as string,",
				"          MATNR as string,",
				"          MATWA as string,",
				"          PMATN as string,",
				"          CHARG as string,",
				"          MATKL as string,",
				"          ARKTX as string,",
				"          PSTYV as string,",
				"          POSAR as string,",
				"          LFREL as string,",
				"          FKREL as string,",
				"          UEPOS as string,",
				"          GRPOS as string,",
				"          ABGRU as string,",
				"          PRODH as string,",
				"          ZWERT as string,",
				"          ZMENG as string,",
				"          ZIEME as string,",
				"          UMZIZ as string,",
				"          UMZIN as string,",
				"          MEINS as string,",
				"          SMENG as string,",
				"          ABLFZ as string,",
				"          ABDAT as string,",
				"          ABSFZ as string,",
				"          POSEX as string,",
				"          KDMAT as string,",
				"          KBVER as string,",
				"          KEVER as string,",
				"          VKGRU as string,",
				"          VKAUS as string,",
				"          GRKOR as string,",
				"          FMENG as string,",
				"          UEBTK as string,",
				"          UEBTO as string,",
				"          UNTTO as string,",
				"          FAKSP as string,",
				"          ATPKZ as string,",
				"          RKFKF as string,",
				"          SPART as string,",
				"          GSBER as string,",
				"          NETWR as string,",
				"          WAERK as string,",
				"          ANTLF as string,",
				"          KZTLF as string,",
				"          CHSPL as string,",
				"          KWMENG as string,",
				"          LSMENG as string,",
				"          KBMENG as string,",
				"          KLMENG as string,",
				"          VRKME as string,",
				"          UMVKZ as string,",
				"          UMVKN as string,",
				"          BRGEW as string,",
				"          NTGEW as string,",
				"          GEWEI as string,",
				"          VOLUM as string,",
				"          VOLEH as string,",
				"          VBELV as string,",
				"          POSNV as string,",
				"          VGBEL as string,",
				"          VGPOS as string,",
				"          VOREF as string,",
				"          UPFLU as string,",
				"          ERLRE as string,",
				"          LPRIO as string,",
				"          WERKS as string,",
				"          LGORT as string,",
				"          VSTEL as string,",
				"          ROUTE as string,",
				"          STKEY as string,",
				"          STDAT as string,",
				"          STLNR as string,",
				"          STPOS as string,",
				"          AWAHR as string,",
				"          ERDAT as string,",
				"          ERNAM as string,",
				"          ERZET as string,",
				"          TAXM1 as string,",
				"          TAXM2 as string,",
				"          TAXM3 as string,",
				"          TAXM4 as string,",
				"          TAXM5 as string,",
				"          TAXM6 as string,",
				"          TAXM7 as string,",
				"          TAXM8 as string,",
				"          TAXM9 as string,",
				"          VBEAF as string,",
				"          VBEAV as string,",
				"          VGREF as string,",
				"          NETPR as string,",
				"          KPEIN as string,",
				"          KMEIN as string,",
				"          SHKZG as string,",
				"          SKTOF as string,",
				"          MTVFP as string,",
				"          SUMBD as string,",
				"          KONDM as string,",
				"          KTGRM as string,",
				"          BONUS as string,",
				"          PROVG as string,",
				"          EANNR as string,",
				"          PRSOK as string,",
				"          BWTAR as string,",
				"          BWTEX as string,",
				"          XCHPF as string,",
				"          XCHAR as string,",
				"          LFMNG as string,",
				"          STAFO as string,",
				"          WAVWR as string,",
				"          KZWI1 as string,",
				"          KZWI2 as string,",
				"          KZWI3 as string,",
				"          KZWI4 as string,",
				"          KZWI5 as string,",
				"          KZWI6 as string,",
				"          STCUR as string,",
				"          AEDAT as string,",
				"          EAN11 as string,",
				"          FIXMG as string,",
				"          PRCTR as string,",
				"          MVGR1 as string,",
				"          MVGR2 as string,",
				"          MVGR3 as string,",
				"          MVGR4 as string,",
				"          MVGR5 as string,",
				"          KMPMG as string,",
				"          SUGRD as string,",
				"          SOBKZ as string,",
				"          VPZUO as string,",
				"          PAOBJNR as string,",
				"          PS_PSP_PNR as string,",
				"          AUFNR as string,",
				"          VPMAT as string,",
				"          VPWRK as string,",
				"          PRBME as string,",
				"          UMREF as string,",
				"          KNTTP as string,",
				"          KZVBR as string,",
				"          SERNR as string,",
				"          OBJNR as string,",
				"          ABGRS as string,",
				"          BEDAE as string,",
				"          CMPRE as string,",
				"          CMTFG as string,",
				"          CMPNT as string,",
				"          CMKUA as string,",
				"          CUOBJ as string,",
				"          CUOBJ_CH as string,",
				"          CEPOK as string,",
				"          KOUPD as string,",
				"          SERAIL as string,",
				"          ANZSN as string,",
				"          NACHL as string,",
				"          MAGRV as string,",
				"          MPROK as string,",
				"          VGTYP as string,",
				"          PROSA as string,",
				"          UEPVW as string,",
				"          KALNR as string,",
				"          KLVAR as string,",
				"          SPOSN as string,",
				"          KOWRR as string,",
				"          STADAT as string,",
				"          EXART as string,",
				"          PREFE as string,",
				"          KNUMH as string,",
				"          CLINT as string,",
				"          CHMVS as string,",
				"          STLTY as string,",
				"          STLKN as string,",
				"          STPOZ as string,",
				"          STMAN as string,",
				"          ZSCHL_K as string,",
				"          KALSM_K as string,",
				"          KALVAR as string,",
				"          KOSCH as string,",
				"          UPMAT as string,",
				"          UKONM as string,",
				"          MFRGR as string,",
				"          PLAVO as string,",
				"          KANNR as string,",
				"          CMPRE_FLT as string,",
				"          ABFOR as string,",
				"          ABGES as string,",
				"          J_1BCFOP as string,",
				"          J_1BTAXLW1 as string,",
				"          J_1BTAXLW2 as string,",
				"          J_1BTXSDC as string,",
				"          WKTNR as string,",
				"          WKTPS as string,",
				"          SKOPF as string,",
				"          KZBWS as string,",
				"          WGRU1 as string,",
				"          WGRU2 as string,",
				"          KNUMA_PI as string,",
				"          KNUMA_AG as string,",
				"          KZFME as string,",
				"          LSTANR as string,",
				"          TECHS as string,",
				"          MWSBP as string,",
				"          BERID as string,",
				"          PCTRF as string,",
				"          LOGSYS_EXT as string,",
				"          J_1BTAXLW3 as string,",
				"          J_1BTAXLW4 as string,",
				"          J_1BTAXLW5 as string,",
				"          STOCKLOC as string,",
				"          SLOCTYPE as string,",
				"          MSR_RET_REASON as string,",
				"          MSR_REFUND_CODE as string,",
				"          MSR_APPROV_BLOCK as string,",
				"          {_BEV1_SRFUND} as string,",
				"          AUFPL_OLC as string,",
				"          APLZL_OLC as string,",
				"          FERC_IND as string,",
				"          KOSTL as string,",
				"          FONDS as string,",
				"          FISTL as string,",
				"          FKBER as string,",
				"          GRANT_NBR as string,",
				"          BUDGET_PD as string,",
				"          IUID_RELEVANT as string,",
				"          MILL_SE_GPOSN as string,",
				"          PRS_OBJNR as string,",
				"          ARSNUM as string,",
				"          ARSPOS as string,",
				"          WTYSC_CLMITEM as string,",
				"          ZZMARCA as string,",
				"          ZZTIPO as string,",
				"          ZZGENERO as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(ZWERT = toDecimal(ZWERT ,13, 2),",
				"          ZMENG = toDecimal(ZMENG ,13, 3),",
				"          UMZIZ = toDecimal(UMZIZ ,5, 0),",
				"          UMZIN = toDecimal(UMZIN ,5, 0),",
				"          SMENG = toDecimal(SMENG ,13, 3),",
				"          ABLFZ = toDecimal(ABLFZ ,13, 3),",
				"          ABSFZ = toDecimal(ABSFZ ,13, 3),",
				"          KBVER = toDecimal(KBVER ,3, 0),",
				"          KEVER = toDecimal(KEVER ,3, 0),",
				"          UEBTO = toDecimal(UEBTO ,3, 1),",
				"          UNTTO = toDecimal(UNTTO ,3, 1),",
				"          NETWR = toDecimal(NETWR ,15, 2),",
				"          ANTLF = toDecimal(ANTLF ,1, 0),",
				"          KWMENG = toDecimal(KWMENG,15, 3),",
				"          LSMENG = toDecimal(LSMENG,15, 3),",
				"          KBMENG = toDecimal(KBMENG,15, 3),",
				"          KLMENG = toDecimal(KLMENG,15, 3),",
				"          UMVKZ = toDecimal(UMVKZ ,5, 0),",
				"          UMVKN = toDecimal(UMVKN ,5, 0),",
				"          BRGEW = toDecimal(BRGEW ,15, 3),",
				"          NTGEW = toDecimal(NTGEW ,15, 3),",
				"          VOLUM = toDecimal(VOLUM ,15, 3),",
				"          STPOS = toDecimal(STPOS ,5, 0),",
				"          VBEAF = toDecimal(VBEAF ,5, 2),",
				"          VBEAV = toDecimal(VBEAV ,5, 2),",
				"          NETPR = toDecimal(NETPR ,11, 2),",
				"          KPEIN = toDecimal(KPEIN ,5, 0),",
				"          LFMNG = toDecimal(LFMNG ,13, 3),",
				"          WAVWR = toDecimal(WAVWR ,13, 2),",
				"          KZWI1 = toDecimal(KZWI1 ,13, 2),",
				"          KZWI2 = toDecimal(KZWI2 ,13, 2),",
				"          KZWI3 = toDecimal(KZWI3 ,13, 2),",
				"          KZWI4 = toDecimal(KZWI4 ,13, 2),",
				"          KZWI5 = toDecimal(KZWI5 ,13, 2),",
				"          KZWI6 = toDecimal(KZWI6 ,13, 2),",
				"          STCUR = toDecimal(STCUR ,9, 5),",
				"          KMPMG = toDecimal(KMPMG ,13, 3),",
				"          UMREF = toFloat(UMREF),",
				"          CMPRE = toDecimal(CMPRE ,11, 2),",
				"          CMKUA = toDecimal(CMKUA ,9, 5),",
				"          ANZSN = toInteger(ANZSN),",
				"          CMPRE_FLT = toFloat(CMPRE_FLT),",
				"          ABGES = toFloat(ABGES),",
				"          MWSBP = toDecimal(MWSBP ,13, 2)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     partitionFileNames:['TX_VBAP_ene2021_abr2022.parquet'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}