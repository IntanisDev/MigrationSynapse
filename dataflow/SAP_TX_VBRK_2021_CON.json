{
	"name": "SAP_TX_VBRK_2021_CON",
	"properties": {
		"folder": {
			"name": "Datalake_Levis/Transacciones/02 Consumption"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "TX_VBRK_2021_ST",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DL_PQT_VBRK",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          MANDT as string,",
				"          VBELN as string,",
				"          FKART as string,",
				"          FKTYP as string,",
				"          VBTYP as string,",
				"          WAERK as string,",
				"          VKORG as string,",
				"          VTWEG as string,",
				"          KALSM as string,",
				"          KNUMV as string,",
				"          VSBED as string,",
				"          FKDAT as string,",
				"          BELNR as string,",
				"          GJAHR as string,",
				"          POPER as string,",
				"          KONDA as string,",
				"          KDGRP as string,",
				"          BZIRK as string,",
				"          PLTYP as string,",
				"          INCO1 as string,",
				"          INCO2 as string,",
				"          EXPKZ as string,",
				"          RFBSK as string,",
				"          MRNKZ as string,",
				"          KURRF as string,",
				"          CPKUR as string,",
				"          VALTG as string,",
				"          VALDT as string,",
				"          ZTERM as string,",
				"          ZLSCH as string,",
				"          KTGRD as string,",
				"          LAND1 as string,",
				"          REGIO as string,",
				"          COUNC as string,",
				"          CITYC as string,",
				"          BUKRS as string,",
				"          TAXK1 as string,",
				"          TAXK2 as string,",
				"          TAXK3 as string,",
				"          TAXK4 as string,",
				"          TAXK5 as string,",
				"          TAXK6 as string,",
				"          TAXK7 as string,",
				"          TAXK8 as string,",
				"          TAXK9 as string,",
				"          NETWR as string,",
				"          ZUKRI as string,",
				"          ERNAM as string,",
				"          ERZET as string,",
				"          ERDAT as string,",
				"          STAFO as string,",
				"          KUNRG as string,",
				"          KUNAG as string,",
				"          MABER as string,",
				"          STWAE as string,",
				"          EXNUM as string,",
				"          STCEG as string,",
				"          AEDAT as string,",
				"          SFAKN as string,",
				"          KNUMA as string,",
				"          FKART_RL as string,",
				"          FKDAT_RL as string,",
				"          KURST as string,",
				"          MSCHL as string,",
				"          MANSP as string,",
				"          SPART as string,",
				"          KKBER as string,",
				"          KNKLI as string,",
				"          CMWAE as string,",
				"          CMKUF as string,",
				"          HITYP_PR as string,",
				"          BSTNK_VF as string,",
				"          VBUND as string,",
				"          FKART_AB as string,",
				"          KAPPL as string,",
				"          LANDTX as string,",
				"          STCEG_H as string,",
				"          STCEG_L as string,",
				"          XBLNR as string,",
				"          ZUONR as string,",
				"          MWSBK as string,",
				"          LOGSYS as string,",
				"          FKSTO as string,",
				"          XEGDR as string,",
				"          RPLNR as string,",
				"          LCNUM as string,",
				"          J_1AFITP as string,",
				"          KURRF_DAT as string,",
				"          AKWAE as string,",
				"          AKKUR as string,",
				"          KIDNO as string,",
				"          BVTYP as string,",
				"          NUMPG as string,",
				"          BUPLA as string,",
				"          VKONT as string,",
				"          FKK_DOCSTAT as string,",
				"          NRZAS as string,",
				"          SPE_BILLING_IND as string,",
				"          VTREF as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(GJAHR = toInteger(GJAHR),",
				"          POPER = toInteger(POPER),",
				"          KURRF = toDecimal(KURRF,9,5),",
				"          VALTG = toInteger(VALTG),",
				"          NETWR = toDecimal(NETWR,15,2),",
				"          CMKUF = toDecimal(CMKUF,9,5),",
				"          MWSBK = toDecimal(MWSBK,13,2),",
				"          AKKUR = toDecimal(AKKUR,9,5),",
				"          NUMPG = toInteger(NUMPG)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     partitionFileNames:['TX_VBRK_ene2021_abr2022.parquet'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}